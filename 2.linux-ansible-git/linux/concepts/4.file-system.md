# **4. File System**

### **Definition**

* A **file system** is a way the operating system **organizes, stores, and manages data** on a storage device (disk, SSD, USB).
* It decides how files are named, stored, accessed, and structured in directories.

---

### **Types of File System**

* **ext2 / ext3 / ext4** → Common Linux filesystems
* **xfs** → High-performance, large file support
* **btrfs** → Advanced features (snapshots, self-healing)
* **FAT32 / exFAT / NTFS** → Windows-compatible (Linux can mount them)
* **NFS** → Network File System (shared across machines)
* **ISO9660** → Used for CDs/DVDs

Check filesystem type:

```bash
df -T
lsblk -f
```

---

### **1. Linux Directory Structure**

* `/` → Root of the filesystem
* `/bin` → Essential binaries (ls, cp, mv)
* `/sbin` → System binaries (shutdown, mount)
* `/etc` → Configuration files
* `/root` → Home dir of root user
* `/var` → Variable data (logs, cache)
* `/usr` → User programs, libraries
* `/home` → User home directories
* `/tmp` → Temporary files
* `/dev` → Device files
* `/proc` → Virtual kernel/process info
* `/boot` → Bootloader files

---

### **2. Absolute vs Relative Paths**

* **Absolute Path**: Starts from root `/`

  * Example: `/home/konka/docs/file.txt`
* **Relative Path**: Based on current directory

  * Example: `../docs/file.txt`

---

### **3. Mount Points**

* A **mount point** is where a filesystem is attached in Linux.
* Example:

  * `/dev/sda1` → `/`
  * `/dev/sdb1` → `/data`

Check:

```bash
mount
df -h
```

---

### **4. File Types**

* **Regular file (-)** → Text, binary
* **Directory (d)** → Folder
* **Symbolic link (l)** → Shortcut
* **Block device (b)** → Disks
* **Character device (c)** → Keyboard, terminal
* **Socket (s)** → IPC communication
* **FIFO/Named Pipe (p)** → Process communication

---

## **5. Soft vs Hard Links – Deep Explanation**

### 🔹 **What is an Inode?**

* In Linux, every file is represented by an **inode** (index node).
* An inode stores **metadata about a file**:

  * File type (regular, directory, device, etc.)
  * File size
  * Permissions (rwx)
  * Owner, group
  * Timestamps (created, modified, accessed)
  * **Pointers to data blocks** on disk (where the file’s content lives)

👉 Important: **The filename is not stored in the inode.**
Filenames are just directory entries pointing to inodes.

You can check inode number:

```bash
ls -i file.txt
```

---

### 🔹 **Hard Link**

* A **hard link** is just another **directory entry pointing to the same inode**.
* That means both names (`file1`, `file2`) share the **same inode number** and point to the same data.
* If one is deleted, the inode (and actual data blocks) still exist until **all links are removed**.

Example:

```bash
ln file1 file2
ls -li
```

You’ll see both `file1` and `file2` have the same inode number.

---

### 🔹 **Why Hard Links Cannot Cross File Systems**

* Each filesystem has its **own set of inodes**.
* Inode numbers are unique **only within one filesystem**.
* So if you try to create a hard link across filesystems:

  * `ln /mnt/disk1/file /mnt/disk2/file2` → ❌ error
* Reason: The target filesystem has no idea about the inode structure of the source filesystem.

---

### 🔹 **Soft Link (Symbolic Link)**

* A **soft link** is a **special file** that just stores the **path to another file**.
* It does not point to the inode directly — it points to the **filename**.
* That’s why:

  * If the original file is deleted, the symlink becomes **dangling (broken)**.
  * Since it only stores a path, it can **point to any location** (even across filesystems).

Example:

```bash
ln -s /mnt/disk1/file /mnt/disk2/file2
ls -li
```

---

### 🔹 **Key Differences**

| Feature           | Hard Link                  | Soft Link                      |
| ----------------- | -------------------------- | ------------------------------ |
| Points to         | Same inode (data directly) | Path of the file               |
| Cross Filesystems | ❌ Not possible             | ✅ Possible                     |
| Original Deleted  | Still works                | Becomes broken                 |
| Inode Number      | Same as original           | Different                      |
| Disk Usage        | Doesn’t take extra space   | Needs a tiny inode for symlink |

---

✅ **So the rule:**

* Hard link = direct inode reference (must be in the same filesystem).
* Soft link = filename pointer (can cross filesystems, but breaks if file is gone).

---

### **6. `.` and `..` in Linux**

1. **`.` (single dot)**

   * Refers to the **current directory**.
   * Example:

     ```bash
     ls .         # List files in current directory
     ./script.sh  # Run script in current directory
     ```
   * Often used in **relative paths**.

2. **`..` (double dot)**

   * Refers to the **parent directory** (one level up).
   * Example:

     ```bash
     cd ..        # Go up one directory
     ls ../dir    # List files in sibling directory
     ```

---

### **Why they exist**

* They are **special directory entries** automatically created by the filesystem in every directory.
* Helps with **navigation relative to the current location**.

---

✅ **In short:**

* `.` = **current directory**
* `..` = **parent directory**

---