Perfect, Konka üëç Let‚Äôs break down **File Permissions & UMASK** in detail with examples and explanations.

---

# **8. File Permissions & UMASK**

### **Definition**

* **File permissions** control **who can read, write, or execute** a file or directory.
* **UMASK** sets **default permissions** for newly created files and directories.

---

### **1. Read, Write, Execute Permissions**

| Permission | Symbol | Meaning                                       |
| ---------- | ------ | --------------------------------------------- |
| Read       | `r`    | Can view file contents or list directory      |
| Write      | `w`    | Can modify file or directory contents         |
| Execute    | `x`    | Can run file as a program or access directory |

**Example:**

```bash
ls -l file.txt
-rwxr--r-- 1 konka devops 100 Sep30 04:00 file.txt
```

* Owner `konka` ‚Üí `rwx` (read, write, execute)
* Group `devops` ‚Üí `r--` (read only)
* Others ‚Üí `r--` (read only)

---

### **2. Owner, Group, Others**

* **Owner** ‚Üí The user who owns the file
* **Group** ‚Üí Users in the file‚Äôs group
* **Others** ‚Üí Everyone else

**Example:**

```bash
chown root file.txt        # Change owner to root
chgrp devops file.txt      # Change group to devops
```

---

### **3. `chmod`, `chown`, `chgrp`**

#### **Change Permissions (`chmod`)**

* Symbolic mode:

```bash
chmod u+r file.txt     # Add read to owner
chmod g+w file.txt     # Add write to group
chmod o-x file.txt     # Remove execute from others
chmod u=rwx,g=rx,o=r file.txt  # Set exact permissions
```

* Numeric mode:

```bash
chmod 755 file.txt     # rwx for owner, rx for group/others
chmod 644 file.txt     # rw for owner, r for group/others
```

* Explanation of numbers:

  * `r=4, w=2, x=1` ‚Üí sum gives numeric value
  * `755` ‚Üí 7(owner=rwx), 5(group=rx), 5(others=rx)

#### **Change Owner (`chown`)**

```bash
sudo chown konka file.txt       # Change owner
sudo chown konka:devops file.txt # Change owner and group
```

#### **Change Group (`chgrp`)**

```bash
sudo chgrp devops file.txt      # Change only group
```

---

### **4. Special Permissions**

| Permission | Symbol | Effect                                                                 |
| ---------- | ------ | ---------------------------------------------------------------------- |
| SUID       | `s`    | Executable runs with **owner‚Äôs privileges** (commonly root)            |
| SGID       | `s`    | Executable runs with **group‚Äôs privileges**; directories inherit group |
| Sticky Bit | `t`    | Files in directory can **only be deleted by owner** (e.g., `/tmp`)     |

**Examples:**

```bash
chmod u+s /usr/bin/passwd   # SUID
chmod g+s /shared           # SGID on directory
chmod +t /tmp               # Sticky bit
```

---

### **5. UMASK & Default Permissions**

* **UMASK** = **default permission mask** for new files/directories
* Linux subtracts UMASK from max permissions to create files:

  * Max permissions: `666` for files, `777` for directories
* Example:

```bash
umask                       # Show current mask, e.g., 0022
touch file.txt               # Default permission = 644 (666-022)
mkdir test                   # Default permission = 755 (777-022)
```

* Common UMASK values:

  * `022` ‚Üí Files: 644, Directories: 755
  * `002` ‚Üí Files: 664, Directories: 775 (shared group write)

---

### **Practical Examples**

```bash
# Create file and check default permissions
umask 0022
touch file.txt
ls -l file.txt          # -rw-r--r--

# Set SUID on a file
sudo chmod u+s /usr/bin/passwd
ls -l /usr/bin/passwd   # -rwsr-xr-x

# Make directory with SGID
mkdir shared
chmod g+s shared
ls -ld shared           # drwxr-sr-x
```

---

‚úÖ **Summary:**

* **Permissions**: r, w, x ‚Üí control access
* **Owner, Group, Others** ‚Üí who has access
* **Special bits**: SUID, SGID, Sticky ‚Üí extra control
* **UMASK** ‚Üí default permissions for new files/directories

---

### **Default UMASK**

| User Type       | Default UMASK              | Resulting Permissions                                      |
| --------------- | -------------------------- | ---------------------------------------------------------- |
| **Normal User** | `0022`                     | Files: `644` (rw-r--r--)<br>Directories: `755` (rwxr-xr-x) |
| **Root User**   | `0022` or sometimes `0077` | Files: `644` or `600`<br>Directories: `755` or `700`       |

---

### **Explanation**

1. **UMASK = 0022** (most common for normal users)

   * Subtract from max permissions (`666` for files, `777` for directories)
   * Files: `666 - 022 = 644` ‚Üí owner rw, group r, others r
   * Directories: `777 - 022 = 755` ‚Üí owner rwx, group rx, others rx

2. **UMASK = 0077** (often used for root)

   * Files: `666 - 077 = 600` ‚Üí only owner can read/write
   * Directories: `777 - 077 = 700` ‚Üí only owner can read/write/execute
   * Ensures **root‚Äôs files are private and secure**

---

### **Check UMASK**

```bash
umask         # Show current UMASK
umask -S      # Show symbolic representation (u=rwx,g=rx,o=rx)
```

**Example:**

```bash
$ umask
0022

$ umask -S
u=rwx,g=rx,o=rx
```

---

‚úÖ **Key Point:**

* Normal users ‚Üí `0022` (shareable, readable by others)
* Root ‚Üí `0022` or `0077` (secure, restricted access)

---