## 11. Web Servers: Nginx

**Nginx:** Lightweight, high-performance web server used for:

* Serving **static content**
* Acting as **reverse/forward proxy**
* Load balancing traffic
* SSL termination

---

### 1. Serving Static Content

**Configuration Example:**

```nginx
server {
    listen 80;
    server_name example.com www.example.com;

    root /var/www/html;
    index index.html index.htm;

    location / {
        try_files $uri $uri/ =404;
    }
}
```

**Explanation:**

* `listen 80` → HTTP port
* `root` → location of static files
* `try_files` → serve file or return 404

---

### 2. Reverse Proxy

**Configuration Example:**

```nginx
server {
    listen 80;
    server_name app.example.com;

    location / {
        proxy_pass http://127.0.0.1:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

**Explanation:**

* Forwards requests to **backend server** at `127.0.0.1:8080`
* `proxy_set_header` → passes original client info

---

### 3. Load Balancer

**Configuration Example:**

```nginx
upstream backend_servers {
    server 192.168.1.101;
    server 192.168.1.102;
}

server {
    listen 80;

    location / {
        proxy_pass http://backend_servers;
    }
}
```

**Explanation:**

* `upstream` → defines multiple backend servers
* `proxy_pass` → distributes traffic among backend servers (default: round-robin)

---

### 4. SSL / HTTPS with Nginx

**Configuration Example:**

```nginx
server {
    listen 443 ssl;
    server_name example.com;

    ssl_certificate /etc/ssl/certs/example.crt;
    ssl_certificate_key /etc/ssl/private/example.key;

    location / {
        root /var/www/html;
        index index.html;
    }
}
```

**Explanation:**

* Enables HTTPS
* SSL certificate and key files specified

---

### 5. Forward Proxy (Optional)

**Configuration Example:**

```nginx
server {
    listen 3128;

    resolver 8.8.8.8;

    location / {
        proxy_pass http://$http_host$request_uri;
    }
}
```

**Explanation:**

* Acts as a **client-side proxy**
* Forwards client requests to internet

---

**Quick Memory Tips for Interviews:**

* **Static Hosting:** serve files directly
* **Reverse Proxy:** hides backend, forwards requests
* **Load Balancer:** distributes traffic among servers
* **SSL Termination:** decrypts HTTPS at Nginx

---

```
                  Internet
                     |
                     v
               +-----------+
               |   Nginx   | 
               |-----------|
               | SSL Term. |
               | LB / Proxy|
               +-----------+
               /     |     \
              /      |      \
             v       v       v
     Backend1      Backend2  Backend3
 (App Server)   (App Server) (App Server)

Key Roles:
1. SSL Termination → Decrypt HTTPS
2. Load Balancer → Distribute traffic to backends
3. Reverse Proxy → Hide backend servers
4. Static Hosting → Serve files directly from Nginx
```

**Quick explanation for interviews:**

* **Nginx** sits at the front, handles SSL, load balancing, and proxies requests.
* **Backends** serve the actual application content.
* **Static files** can be served directly without hitting backends.

---

```
1️⃣ Forward Proxy (Client-side)

Client
  |
  v
+--------+
| Nginx  |  <-- Forward Proxy
+--------+
  |
  v
Internet / External Servers
```

**Explanation:**

* Client sends request to Nginx (proxy).
* Nginx fetches content from the Internet on behalf of the client.
* Hides **client identity** from servers.

---

```
2️⃣ Reverse Proxy (Server-side)

Internet / Clients
        |
        v
     +--------+
     | Nginx  |  <-- Reverse Proxy
     +--------+
     /        \
    v          v
Backend1    Backend2
(App Server)(App Server)
```

**Explanation:**

* Clients send requests to Nginx.
* Nginx forwards requests to internal backend servers.
* Hides **server identity** and can do load balancing, SSL termination.

---

**Easy memory for interviews:**

* **Forward Proxy → hides client**
* **Reverse Proxy → hides server**
