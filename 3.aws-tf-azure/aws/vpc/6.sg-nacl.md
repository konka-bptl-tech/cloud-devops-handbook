## **1. Security Groups (SG) – AWS**

* **What it is:** A **virtual firewall** attached to **EC2 instances** or other resources.
* **Scope:** **Instance-level**.
* **Stateful:** Yes → if you allow inbound traffic, the response is automatically allowed outbound.
* **Rules:** Only **allow rules**. No deny rules.
* **Default:** Denies all inbound traffic, allows all outbound traffic (you can modify).
* **Use case:** Control which IPs or ports can access your instance.

**Example:**

* Allow **HTTP (80)** from anywhere (0.0.0.0/0)
* Allow **SSH (22)** only from your office IP

---

## **2. Network ACLs (NACL) – AWS**

* **What it is:** A **firewall at the subnet level**.
* **Scope:** **Subnet-level**, affects all resources in that subnet.
* **Stateless:** Yes → inbound and outbound rules are evaluated separately, response traffic **must be explicitly allowed**.
* **Rules:** Can **allow or deny** traffic.
* **Default:** Allows all inbound and outbound traffic by default.

**Example:**

* Deny **SSH (22)** from a specific IP range
* Allow **HTTP (80)** from anywhere

---

### **Key Differences**

| Feature    | Security Group               | Network ACL      |
| ---------- | ---------------------------- | ---------------- |
| Level      | Instance                     | Subnet           |
| Stateful?  | Yes                          | No               |
| Rules      | Allow only                   | Allow & Deny     |
| Default    | Deny inbound, allow outbound | Allow all        |
| Evaluation | All rules                    | First match wins |

**Simple analogy:**

* SG = **Bodyguard for each server** → checks who can enter.
* NACL = **Gate at the neighborhood** → controls all traffic coming in/out of the subnet.

---

### **1. Private Subnet EC2 Accessing Internet**

**Scenario:**
You have an EC2 instance in a private subnet. SG allows outbound HTTP/HTTPS. NACL allows inbound and outbound all traffic. Yet, the EC2 cannot reach the internet.

**Answer:**
This is because **private subnets don’t have a route to the Internet Gateway**. SG and NACL are fine, but without a **NAT Gateway** or **IGW route**, outbound internet traffic cannot go out. Many assume SG/NACL rules alone are enough, but routing is equally important.

---

### **2. EC2 Access Blocked by NACL**

**Scenario:**
An EC2 instance has an SG allowing SSH (port 22) from your office IP. You try to connect via SSH, but it fails.

**Answer:**
Even though the SG allows it, the **subnet’s NACL might be denying inbound or outbound port 22**. Remember, **NACLs are stateless**, so you must allow **both inbound from your IP and outbound response**. SG statefulness won’t bypass a restrictive NACL.

---

### **3. Multiple Security Groups**

**Scenario:**
Your EC2 has two SGs:

* SG1 allows HTTP (80).
* SG2 allows SSH (22).

You try HTTP, it works. You try SSH, it works.

**Explanation:**
Rules from **multiple SGs are cumulative (union)**. If **any SG allows traffic**, it’s permitted. Some candidates incorrectly think rules are “intersected,” meaning only traffic allowed by all SGs passes — that’s wrong.

---

### **4. NACL Rule Order Confusion**

**Scenario:**
Your NACL has:

* Rule 100: Allow HTTP (80) inbound.
* Rule 200: Deny all inbound.

You try to reach EC2 via HTTP.

**Answer:**
Traffic is allowed because **NACL rules are evaluated in number order, first match wins**. The deny-all rule doesn’t apply because HTTP matched the first rule. Tricky part: people assume “deny all” always overrides.

---

### **5. SG Allow vs NACL Deny**

**Scenario:**
SG allows all traffic. NACL denies all traffic. EC2 cannot be accessed.

**Answer:**
NACL works at the **subnet level**. Even if SG allows everything, the **subnet NACL blocks it**, so traffic never reaches the instance. Many candidates forget that **both must allow traffic**.

---

### **6. Outbound Block in NACL**

**Scenario:**
EC2 in private subnet can receive HTTP requests from a public subnet, but cannot send responses.

**Answer:**
Because NACLs are **stateless**, you must allow **outbound response traffic**. SG being stateful only helps for outbound replies **to allowed inbound connections**, but NACL requires explicit rules for both directions.

---

### **7. Restricting Traffic to a Specific IP**

**Scenario:**
You want an EC2 to accept SSH from your office only, and block all others. SG allows only your office IP on port 22. NACL allows all inbound/outbound.

**Explanation:**
This works fine. SG rules are **instance-level and stateful**, so only your office IP can reach EC2. NACL being open doesn’t override SG restrictions. Tricky point: many assume NACL must also restrict — it’s optional here.

---

### **8. Multiple EC2s in Same Subnet with Different SGs**

**Scenario:**
Two EC2s in same subnet. NACL allows all traffic. EC21 SG allows HTTP only, EC22 SG allows SSH only.

**Answer:**
EC21 can only be accessed via HTTP, EC22 only via SSH. NACL doesn’t differentiate between instances, but **SGs enforce instance-level rules**. Many candidates assume NACL overrides SG — it only blocks traffic at subnet, not instance specificity.

---

### **9. Mixing Public and Private Subnets**

**Scenario:**
You have a public subnet with SG allowing HTTP/HTTPS, private subnet with SG allowing RDS traffic. NACL allows all. Private EC2 cannot connect to public EC2 HTTP endpoint.

**Answer:**
Check routing: if the private subnet has **no route to IGW** or **internet-facing public EC2**, traffic won’t flow. Even with open SGs and NACLs, **routing and subnet types matter**. Many assume SG/NACL alone control connectivity.

---

### **10. Restricting EC2 Access to Only VPC Endpoint**

**Scenario:**
You want EC2 to access S3 **only via Gateway Endpoint**, no public internet. SG allows all outbound, NACL allows all.

**Answer:**
You must **modify S3 bucket policy** to allow access **only from VPC Endpoint**. Traffic will still attempt public S3 if bucket policy allows it. Tricky part: SG/NACL don’t control **service-level access** — bucket policy and endpoint must be configured.

---


